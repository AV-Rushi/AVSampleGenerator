<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Configure File</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <style>
        #formatName ,#fileName,#batchlevel,#transactionlevel,#BrnchId{
            border-color: lightcoral;
            border-width: 2px;
            box-shadow: 1px 1px 2px;
        }

        #formatName:hover,#fileName:hover,#batchlevel:hover,#transactionlevel:hover,#BrnchId:hover {
            border-color: black;
            border-width: 2px;
            box-shadow: 2px 2px 4px;
            /* background-color: linen; */
            background-color: rgb(230, 225, 223);
        }
        #btnEdit,#btnSubmit,#btnReset{
            background-color:blue;
            color: white;
            box-shadow: 2px 2px 4px black;
        }
        #btnEdit:hover,#btnSubmit:hover,#btnReset:hover{
            background-color: white;
            color: blue;

        }




    </style>
</head>

<body>
<div class=" container-fluid">
    <form action="configure" id="myform" method="post">
        <div class="row border text-center" id="configform"
             style="background-color:rgb(229, 229, 232);box-shadow: 2px 2px 4px;">
            <div class="col-12 p-0" style="background-color:rgb(245, 238, 227)">
                 <nav class="navbar navbar-expand-lg bg-body-tertiary  p-0 m-0 border-bottom border-dark border-3"
            style="background-color:rgb(245, 238, 227)">
            <div class="container-fluid">
              <a class="navbar-brand" href="#">
                <img src="{{ url_for('static', filename='arthavedh.png') }}" class="w-50 h-50"> </a>

              <div class="collapse navbar-collapse text-start " id="navbarSupportedContent">
                <ul class="navbar-nav mx-auto mb-2 mb-lg-0  ">
                  <h1 style="margin-left: -100px;
font-size:40px; ">CONFIGURATION</h1>
                </ul>

              </div>
            </div>
          </nav>
            </div>

            <div class="row justify-content-center px-5">
                <div class="col-12 col-md-3"></div>
                <div class="col-12 col-md-3 text-start mt-5">
                    <label for="formatName" class="col-form-label fw-bold">Format Name<sup
                style="color: red;">*</sup></label>
                </div>
                <div class="col-12 col-md-4 mt-5">
                    <input type="text" id="formatName" class="form-control ms-1 w-75"
                           placeholder="--Enter Value--" value="{{ template }}" name="formatname" required/>
                </div>
                <div class="col-12 col-md-2"></div>
                <div class="col-12 col-md-3"></div>
                <div class="col-12 col-md-3 text-start mt-4">
                    <label for="fileName" class="col-form-label fw-bold">File Name<sup
                style="color: red;">*</sup></label>
                </div>
                <div class="col-12 col-md-4 mt-4">
                    <input type="text" id="fileName" class="form-control ms-1 w-75"
                           placeholder="--Enter Value--" value="{{ file }}" name="filename" required/>
                </div>
                <div class="col-12 col-md-2"></div>
                            <div class="col-12 col-md-3"></div>
                            <div class="col-12 col-md-3 text-start mt-4">
                                <label for="batchlevel" class=" fw-bold">Batch Tag</label>
                            </div>
                            <div class="col-12 col-md-4 text-center mt-4">
                                <input type="text" id="batchlevel" class="form-control ms-1 w-75"
                                       placeholder="--Enter Value--" value="{{ batchtag }}" name="batchelement"/>
                            </div>
                            <div class="col-12 col-md-2"></div>
                            <div class="col-12 col-md-3"></div>
                            <div class="col-12 col-md-3 text-start mt-4">
                                <label for="transactionlevel" class=" fw-bold">Transaction Tag</label>
                            </div>

                            <div class="col-12 col-md-4 mt-4 ">
                                <input type="text" id="transactionlevel" class="form-control ms-1 w-75"
                                       placeholder="--Enter Value--" value="{{ txntag }}" name="transactionelement"/>
                            </div>
                            <div class="col-12 col-md-2"></div>



                    <div class="row mt-3 pt-3 ms-1 text-center" id="edit_section" >

                        <div class="col-12 col-md-12 border shadow ms-2 " id="editdiv" disabled>
                               <div class="row mt-5 text-start mb-5" id="mydiv">
                                       {% for row in data %}
                                        <div class="col-12 col-md-1 mt-2 text-center">
                                            <input class="form-check-input" type="checkbox"  value="true"
                                                id="flexCheckChecked{{ loop.index }}" name="flexCheckChecked{{ loop.index }}" checked data-label="{{ row[0] }}" disabled>
                                        </div>
                                        <div class="col-12 col-md-2">
                                            <label for="BrnchId[]" class="col-form-label fw-bold" id="lableforcheckbox">{{ row[0] }}</label>
                                            <input type="hidden" name="labels[]" value="{{ row[0] }}">
                                        </div>
                                        <div class="col-12 col-md-5">
                                            <input type="text" id="BrnchId[]" class="form-control shadow ms-1 w-100 mt-1 border-bottom"
                                                placeholder="--Enter Value--" name="BrnchId[]" value="{{ row[1] }}" disabled/>
                                            <input type = "hidden" name = "current_brnch_ids[]" value = "{{ row[1] }}">
                                        </div>
                                   <div class="col-12 col-md-3">
                                       <input type="text" class="form-control shadow ms-1 w-100 mt-1" disabled>
                                   </div>
                                   <div class="col-12 col-md-1">
                                       <input type="submit" class="btn btn-primary text-atart" value="Validate">
                                   </div>
                            {% endfor %}

                             <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
                            <script>
                            function checkCheckbox() {
                                var labels = [];
                                $("input[type=checkbox]").each(function() {
                                    if (!this.checked) {
                                        labels.push($(this).data("label"));
                                    }
                                });
                                if (labels.length > 0) {
                                    $.ajax({
                                        url: '/configure',
                                        type: 'POST',
                                        data: {'checkbox': 'unchecked',
                                                'labels': labels,
                                                'save': 'clicked',
                                                },
                                        success: function(response) {
                                            console.log(response);
                                        }
                                    });
                                }
                                var saveButton = document.getElementById("btn");
                                saveButton.value = "clicked";
                                saveButton.disabled = false;
                                return true;
                            }
                            </script>
                            </div>
                         <div class="row mt-5 text-start mb-5" id="new">
                          </div>
                        </div>
                         <div class="col-12 col-md-12 text-center mt-5 mb-3">
                                    <button type="button" class="btn btn-primary w-25 mx-4" id="btnEdit">Edit</button>
<!--                                     <button type="button" class="btn btn-primary w-25" id="btnSave" disabled>Save</button>-->
                                  <button type="submit" class="btn btn-primary w-25" id="btn" name="save" onclick="return checkCheckbox()">Save</button>

                                </div>
                    </div>


<script>
        const myDiv = document.getElementById("editdiv");
const editBtn = document.getElementById("btnEdit");
const saveBtn = document.getElementById("btnSave");

editBtn.addEventListener("click", () => {
  myDiv.querySelectorAll("input").forEach(input => input.disabled = false); // Enable all input elements inside the div
  saveBtn.disabled = false; // Enable the save button
});

saveBtn.addEventListener("click", () => {
  const inputs = myDiv.querySelectorAll("input"); // Get all input elements inside the div
  const editedValues = Array.from(inputs).map(input => input.value); // Map the input elements to their edited values
  console.log("Edited values:", editedValues); // Log the edited values to console
  inputs.forEach(input => input.disabled = true); // Disable all input elements inside the div
  editBtn.disabled = false; // Enable the edit button again
  saveBtn.disabled = true; // Disable the save button again
});

      </script>

<!--                <script>-->
<!--	 function addItem() {-->
<!--  // Get the values of the checkbox, dropdown, and input box-->
<!--  const checkbox = document.getElementById("checkbox");-->
<!--  const dropdownValue = document.getElementById("my-dropdown").value;-->
<!--  const inputValue = document.getElementById("my-input").value;-->

<!--  // Create a new element with the selected values-->
<!--  const newElement = document.createElement("div");-->
<!--  const newCheckbox = document.createElement("input");-->
<!--  newCheckbox.type = "checkbox";-->
<!--  newCheckbox.checked = checkbox.checked;-->
<!--  newElement.appendChild(newCheckbox);-->
<!--  newElement.innerHTML += `${dropdownValue} <input type="text" value="${inputValue}" disabled>`;-->

<!--  // Append the new element to the pre-created div element-->
<!--  const container = document.getElementById("new");-->
<!--  container.appendChild(newElement);-->

<!--  // Reset the checkbox, dropdown, and input box-->
<!--  checkbox.checked = false;-->
<!--  document.getElementById("dropdown").selectedIndex = 0;-->
<!--  document.getElementById("inputBox").value = "";-->
<!--}-->



<!--&lt;!&ndash;function addItem() {&ndash;&gt;-->
<!--&lt;!&ndash;        // Get the values from the dropdown and input box&ndash;&gt;-->
<!--&lt;!&ndash;        var dropdownValue = document.getElementById("my-dropdown").value;&ndash;&gt;-->
<!--&lt;!&ndash;        var inputValue = document.getElementById("my-input").value;&ndash;&gt;-->

<!--&lt;!&ndash;        // Create a new element to hold the added item&ndash;&gt;-->
<!--&lt;!&ndash;        var newItem = document.createElement("div");&ndash;&gt;-->
<!--&lt;!&ndash;        newItem.innerHTML = dropdownValue + " - " + inputValue;&ndash;&gt;-->

<!--&lt;!&ndash;        // Add the new element to the items container&ndash;&gt;-->
<!--&lt;!&ndash;        document.getElementById("new").appendChild(newItem);&ndash;&gt;-->

<!--&lt;!&ndash;        // Reset the dropdown and input box values&ndash;&gt;-->
<!--&lt;!&ndash;        document.getElementById("my-dropdown").value = "Option 1";&ndash;&gt;-->
<!--&lt;!&ndash;        document.getElementById("my-input").value = "";&ndash;&gt;-->
<!--&lt;!&ndash;    }&ndash;&gt;-->
<!--    </script>-->


                    <div class="row" id="container">
                        <div class="col-12 col-md-1 mt-5" >
                             <input type="checkbox" id="checkbox" checked>
    <label for="checkbox"></label>
                        </div>
                        <div class="col-12 col-md-1 text-center mt-5  ">
                            <label for="my-dropdown" class="fw-bold">Name :</label>
                        </div>
                        <div class="col-12 col-md-4 mt-5">
                             <div class="dropdown">
                    <select name="newfieldname" class="form-select" id="my-dropdown" required>
                      <option selected disabled>--Select Key--</option>
                      {% for keys in keyList %}
                            <option value="{{ keys[0] }}">{{ keys[0] }}</option>
                  {% endfor %}
                    </select>
                  </div>
                        </div>
                        <div class="col-12 col-md-1 text-center mt-5 ">
                            <label for="my-input" class="fw-bold">value :</label>
                        </div>
                        <div class="col-12 col-md-4 mt-5">
                             <input type="text" class="shadow py-1 rounded w-100 text-start" name="newpath" id="my-input">
                        </div>
                          <div class="col-12 col-md-1 mt-5 text-start ">
                            <script>
                        function setButtonValue() {
                            var addButton = document.getElementById("add-btn");
                            var buttonValue = addButton.value;
                            document.getElementById("button-value").value = buttonValue;
                             $.ajax({
                            url: "{{ url_for('addValues') }}",
                            type: "POST",
                            data: $("#myform").serialize() + "&buttonValue=addvalue",
                            success: function(response) {
                                      console.log(response);
                            },
                            error: function(jqXHR, textStatus, errorThrown) {
                                console.log(errorThrown);
                            }
                        });
                        }
                            </script>
                            <button type="submit" id="add-btn" class="btn-secondary rounded" name="addButton" value="addvalue" onclick="setButtonValue()">Add</button>
                            <input type="hidden" name="buttonValue" id="button-value">
                        </div>
                        <script>
                                $(document).ready(function() {
                                  $('#myform').submit(function(event) {
                                    event.preventDefault();
                                    var formData = $(this).serialize();
                                    $.ajax({
                                      url: '/configure',
                                      method: 'POST',
                                      data: formData,
                                       success: function(response) {
                                       $('#mydiv').load(document.URL +  ' #mydiv');
                                       alert('.....Successful....!');
                                      },
                                      error: function(error) {
                                        alert('There was an error.');
                                      }
                                    });
                                  });
                                });
                          </script>
                    </div>
                <div class="row mt-5">
                        <div class="col-12 col-md-6 text-end">
                            <button type="submit" class="btn btn-primary mb-5 w-25" id="">Submit</button>
                        </div>
                        <div class="col-12 col-md-6 text-start">
                            <button type="reset" class="btn btn-primary mb-5 w-25" id="btnReset">Reset</button>
                        </div>
                </div>
        </div>
        </div>
    </form>
</div>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
        crossorigin="anonymous"></script>
</body>

</html>