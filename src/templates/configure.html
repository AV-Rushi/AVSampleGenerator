<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Configure File</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <style>
        #formatName ,#fileName,#batchlevel,#transactionlevel,#BrnchId{
            border-color: lightcoral;
            border-width: 2px;
            box-shadow: 1px 1px 2px;
        }

        #formatName:hover,#fileName:hover,#batchlevel:hover,#transactionlevel:hover,#BrnchId:hover {
            border-color: black;
            border-width: 2px;
            box-shadow: 2px 2px 4px;
            /* background-color: linen; */
            background-color: rgb(230, 225, 223);
        }
        #btnEdit,#btnSubmit,#btnReset{
            background-color:blue;
            color: white;
            box-shadow: 2px 2px 4px black;
        }
        #btnEdit:hover,#btnSubmit:hover,#btnReset:hover{
            background-color: white;
            color: blue;

        }

    </style>
</head>

<body>
<div class=" container-fluid">
    <form action="configure" id="myform" method="post">
        <div class="row border text-center" id="configform"
             style="box-shadow: 2px 2px 4px; background-image: url(static/avdarkbackground.png); background-size: 100% 100%;
      background-attachment: fixed;">
            <div class="col-12 p-0" style="background-color:rgb(245, 238, 227)">
                <nav class="navbar navbar-expand-lg bg-body-tertiary  p-0 m-0 border-bottom border-dark border-3"
                     style="background-color:rgb(245, 238, 227)">
                    <div class="container-fluid">
                        <a class="navbar-brand" href="#">
                            <img src="{{ url_for('static', filename='arthavedh.png') }}" class="w-50 h-50"> </a>

                        <div class="collapse navbar-collapse text-start " id="navbarSupportedContent">
                            <ul class="navbar-nav mx-auto mb-2 mb-lg-0  ">
                                <h1 style="margin-left: -100px;
font-size:40px; ">CONFIGURATION</h1>
                            </ul>

                        </div>
                    </div>
                </nav>
            </div>

            <div class="row justify-content-center px-5">
                <div class="col-12 col-md-3"></div>
                <div class="col-12 col-md-3 text-start mt-5">
                    <label for="formatName" class="col-form-label fw-bold text-white">Format Name<sup
                            style="color: red;">*</sup></label>
                </div>
                <div class="col-12 col-md-4 mt-5">
                    <input type="text" id="formatName" class="form-control ms-1 w-75"
                           placeholder="--Enter Value--" value="{{ template }}" name="formatname" required/>
                </div>
                <div class="col-12 col-md-2"></div>
                <div class="col-12 col-md-3"></div>
                <div class="col-12 col-md-3 text-start mt-4">
                    <label for="fileName" class="col-form-label fw-bold text-white">File Name<sup
                            style="color: red;">*</sup></label>
                </div>
                <div class="col-12 col-md-4 mt-4">
                    <input type="text" id="fileName" class="form-control ms-1 w-75"
                           placeholder="--Enter Value--" value="{{ file }}" name="filename" required/>
                </div>
                <div class="col-12 col-md-2"></div>
                <div class="col-12 col-md-3"></div>
                <div class="col-12 col-md-3 text-start mt-4">
                    <label for="batchlevel" class=" fw-bold text-white">Batch Tag</label>
                </div>
                <div class="col-12 col-md-4 text-center mt-4">
                    <input type="text" id="batchlevel" class="form-control ms-1 w-75"
                           placeholder="--Enter Value--" value="{{ batchtag }}" name="batchelement"/>
                </div>
                <div class="col-12 col-md-2"></div>
                <div class="col-12 col-md-3"></div>
                <div class="col-12 col-md-3 text-start mt-4">
                    <label for="transactionlevel" class=" fw-bold text-white">Transaction Tag</label>
                </div>

                <div class="col-12 col-md-4 mt-4 ">
                    <input type="text" id="transactionlevel" class="form-control ms-1 w-75"
                           placeholder="--Enter Value--" value="{{ txntag }}" name="transactionelement"/>
                </div>
                <div class="col-12 col-md-2"></div>


                <div class="row mt-3 pt-3 ms-1 text-center" id="edit_section">

                    <div class="col-12 col-md-12 ms-2 border border-white border-2 rounded bg-light"
                         style="box-shadow:2px 2px 4px black; opacity:0.9" id="editdiv" disabled>
                        <div class="row mt-5 text-start mb-3" id="mydiv">
                            {% for row in data %}
                            <div class="col-12 col-md-1 mt-3 text-center">
                                <!--                                            <input class="form-check-input" type="checkbox"  value="true"-->
                                <!--                                                id="flexCheckChecked{{ loop.index }}" name="flexCheckChecked{{ loop.index }}" checked data-label="{{ row[0] }}" disabled>-->
                                <input class="form-check-input" type="checkbox" value="true"
                                       id="flexCheckChecked{{ loop.index }}" name="flexCheckChecked{{ loop.index }}" {%
                                       if row[2]=='true' %} checked {% endif %} data-label="{{ row[0] }}" disabled>

                            </div>
                            <div class="col-12 col-md-3 text-start">
                                <label for="BrnchId[]" class="col-form-label fw-bold text-dark mt-2"
                                       id="lableforcheckbox">{{ row[0] }}</label>
                                <input type="hidden" name="labels[]" value="{{ row[0] }}">
                            </div>
                            <div class="col-12 col-md-8 ps-3 text-start">
                                <input type="text" id="BrnchId[]"
                                       class="form-control shadow ms-1 w-100 mt-2 border-danger-subtle"
                                       placeholder="--Enter Value--" name="BrnchId[]" value="{{ row[1] }}" disabled/>
                                <input type="hidden" name="current_brnch_ids[]" value="{{ row[1] }}">
                            </div>
                            <!--                                     <div class="col-12 col-md-3">-->
                            <!--                                       <input type="text"  name="validatekey[]" class="form-control shadow ms-1 w-100 mt-1" disabled>-->
                            <!--                                   </div>-->
                            <!--                                   <div class="col-12 col-md-1">-->
                            <!--                                       <input type="submit" name="Validate" id="btnval" class="btn btn-primary text-start" value="Validate" onclick="validatebutton()">-->
                            <!--                                   </div>-->
                            {% endfor %}

<!--                            <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>-->
<!--                            <script>-->
<!--                                    function validatebutton() {-->
<!--                                        event.preventDefault();-->
<!--                                        var valButton = document.getElementById("btnval");-->
<!--                                        valButton.value = "Validate";-->
<!--                                        valButton.disabled = false;-->
<!--                                        $.ajax({-->
<!--                                            url: '/validate',-->
<!--                                            type: 'POST',-->
<!--                                            data: $('#myform').serialize() + '&Validate=Validate',-->
<!--                                            success: function(response) {-->
<!--                                                if (response.status == "success") {-->
<!--                                                    alert('Validation successful!');-->
<!--                                                } else {-->
<!--                                                    alert('Validation failed: ' + response.message);-->
<!--                                                }-->
<!--                                            },-->
<!--                                            error: function(xhr, status, error) {-->
<!--                                                alert('Validation failed: ' + xhr.responseText);-->
<!--                                            }-->
<!--                                        });-->
<!--                                        return false;-->
<!--                                    }-->

<!--                            </script>-->
                            <!--                            <script>-->
                            <!--                            function checkCheckbox() {-->
                            <!--                                var labels = [];-->
                            <!--                                $("input[type=checkbox]").each(function() {-->
                            <!--                                    if (!this.checked) {-->
                            <!--                                        labels.push($(this).data("label"));-->
                            <!--                                    }-->
                            <!--                                });-->
                            <!--                                if (labels.length > 0) {-->
                            <!--                                    $.ajax({-->
                            <!--                                        url: '/configure',-->
                            <!--                                        type: 'POST',-->
                            <!--                                        data: {'checkbox': 'unchecked',-->
                            <!--                                                'labels': labels,-->
                            <!--                                                'save': 'clicked',-->
                            <!--                                                },-->
                            <!--                                        success: function(response) {-->
                            <!--                                            console.log(response);-->
                            <!--                                        }-->
                            <!--                                    });-->
                            <!--                                }-->
                            <!--                                var saveButton = document.getElementById("btn");-->
                            <!--                                saveButton.value = "clicked";-->
                            <!--                                saveButton.disabled = false;-->
                            <!--                                return true;-->
                            <!--                            }-->
                            <!--                            </script>-->
                            <script>

                            $(document).ready(function() {
                                $('input[type=checkbox]').change(function() {
                                    var checked_labels = [];
                                    var unchecked_labels = [];
                                    $('input[type=checkbox]').each(function() {
                                        if ($(this).is(':checked')) {
                                            checked_labels.push($(this).data('label'));
                                        } else {
                                            unchecked_labels.push($(this).data('label'));
                                        }
                                    });
                                    $.ajax({
                                        url: '/updateValues',
                                        type: 'POST',
                                        data: {'checked_labels[]': checked_labels, 'unchecked_labels[]': unchecked_labels},
                                        success: function(response) {
                                            console.log(response);
                                        }
                                    });
                                });
                            });

                            </script>
                            <script>
                        function saveButton() {
                            var saveBtn = document.getElementById("btn");
                            var buttonVal = saveBtn.value;
                            document.getElementById("button-value").value = buttonVal;
                             $.ajax({
                            url: "{{ url_for('updateValues') }}",
                            type: "POST",
                            data: $("#myform").serialize() + "&buttonVal=updateValues",
                            success: function(response) {
                                      console.log(response);
                            },
                            error: function(jqXHR, textStatus, errorThrown) {
                                console.log(errorThrown);
                            }
                        });
                        }
                           $(document).ready(function() {
                                  $('#myform').submit(function(event) {
                                    event.preventDefault();
                                    var formData = $(this).serialize();
                                    $.ajax({
                                      url: '/configure',
                                      method: 'POST',
                                      data: formData,
                                       success: function(response) {
                                       alert('Saved Successfully!');
                                      },
                                      error: function(error) {
                                        alert('There was an error.');
                                      }
                                    });
                                  });
                                });

                            </script>

                        </div>
                        <div class="row mt-5 text-start mb-5" id="new">
                        </div>
                    </div>
                    <div class="col-12 col-md-12 text-center mt-5 mb-3">
                        <button type="button" class="btn btn-primary w-25 mx-4" id="btnEdit">Edit</button>
                        <!--                                     <button type="button" class="btn btn-primary w-25" id="btnSave" disabled>Save</button>-->
                        <button type="submit" class="btn btn-primary w-25" id="btn" name="save" value="updateValues"
                                onclick="saveButton()">Save
                        </button>

                    </div>
                </div>


                <script>
                 const myDiv = document.getElementById("editdiv");
                const editBtn = document.getElementById("btnEdit");
                const saveBtn = document.getElementById("btnSave");

                editBtn.addEventListener("click", () => {
                  myDiv.querySelectorAll("input").forEach(input => input.disabled = false); // Enable all input elements inside the div
                  saveBtn.disabled = false; // Enable the save button
                });

                saveBtn.addEventListener("click", () => {
                  const inputs = myDiv.querySelectorAll("input"); // Get all input elements inside the div
                  const editedValues = Array.from(inputs).map(input => input.value); // Map the input elements to their edited values
                  console.log("Edited values:", editedValues); // Log the edited values to console
                  inputs.forEach(input => input.disabled = true); // Disable all input elements inside the div
                  editBtn.disabled = false; // Enable the edit button again
                  saveBtn.disabled = true; // Disable the save button again
                });


                </script>
<!--                <div class="row" id="container">-->
<!--                    <div class="col-12 col-md-1 mt-5">-->
<!--                        <input type="checkbox" id="checkbox" checked>-->
<!--                        <label for="checkbox"></label>-->
<!--                    </div>-->
<!--                    <div class="col-12 col-md-1 text-center mt-5 text-white ">-->
<!--                        <label for="my-dropdown" class="fw-bold">Name :</label>-->
<!--                    </div>-->
<!--                    <div class="col-12 col-md-4 mt-5">-->
<!--                        <div class="dropdown">-->
<!--                            <select name="newfieldname" class="form-select" id="my-dropdown" required>-->
<!--                                <option selected disabled>&#45;&#45;Select Key&#45;&#45;</option>-->
<!--                                {% for keys in keyList %}-->
<!--                                <option value="{{ keys[0] }}">{{ keys[0] }}</option>-->
<!--                                {% endfor %}-->
<!--                            </select>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                    <div class="col-12 col-md-1 text-center mt-5 text-white ">-->
<!--                        <label for="my-input" class="fw-bold">value :</label>-->
<!--                    </div>-->
<!--                    <div class="col-12 col-md-4 mt-5">-->
<!--                        <input type="text" class="shadow py-1 rounded w-100 text-start" name="newpath" id="my-input">-->
<!--                    </div>-->
<!--                    <div class="col-12 col-md-1 mt-5 text-start ">-->
<!--                        <script>-->
<!--                        function setButtonValue() {-->
<!--                            var addButton = document.getElementById("add-btn");-->
<!--                            var buttonValue = addButton.value;-->
<!--                            document.getElementById("button-value").value = buttonValue;-->
<!--                             $.ajax({-->
<!--                            url: "{{ url_for('addValues') }}",-->
<!--                            type: "POST",-->
<!--                            data: $("#myform").serialize() + "&buttonValue=addvalue",-->
<!--                            success: function(response) {-->
<!--                                      console.log(response);-->
<!--                            },-->
<!--                            error: function(jqXHR, textStatus, errorThrown) {-->
<!--                                console.log(errorThrown);-->
<!--                            }-->
<!--                        });-->
<!--                        }-->


<!--                        </script>-->
<!--                        <button type="submit" id="add-btn" class="btn-secondary rounded" name="addButton"-->
<!--                                value="addvalue" onclick="setButtonValue()">Add-->
<!--                        </button>-->
<!--                        <input type="hidden" name="buttonValue" id="button-value">-->
<!--                    </div>-->
<!--                    <script>-->
<!--                              $(document).ready(function() {-->
<!--                                $('#add-btn').click(function(event) {-->
<!--                                  event.preventDefault();-->
<!--                                  var form = $('#myform');-->
<!--                                  var url = form.attr('action');-->
<!--                                  var formData = form.serialize();-->
<!--                                  $.post(url, formData, function(response) {-->
<!--                                    $('#mydiv').load(' #mydiv > *');-->
<!--                                    });-->
<!--                                });-->
<!--                              });-->


<!--                    </script>-->
<!--                </div>-->
                <div class="row mt-5">
                    <script>
                        function submitbutton() {
                            var subButton = document.getElementById("btnsub");
                            subButton.value = "submitvalue";
                            subButton.disabled = false;
                            $.ajax({
                                url: '/configure',
                                type: 'POST',
                                data: $('#myform').serialize() + '&btnsubmit=submitvalue',
                                success: function(response) {
                                    alert('Data Submitted Successfully!');
                                }
                            });
                            return false;
                        }

                    </script>
                    <div class="col-12 col-md-4 text-end">
                        <button type="submit" class="btn btn-primary mb-5 w-25" id="btnsub" name="btnsubmit"
                                onclick="return submitbutton()">Submit
                        </button>
                    </div>
                    <div class="col-12 col-md-4 text-start">
                        <button type="reset" class="btn btn-primary w-25" id="btnReset">Reset</button>
                    </div>
                    <div class="col-12 col-md-4 text-start">
                        <a href="{{ validate_url }}" class="btn btn-secondary ms-5" id="valid"
                           style="box-shadow: 2px 2px 4px black;">IDconfiguration</a>
                    </div>
                </div>
            </div>
        </div>
    </form>

    <!--    <script>-->
    <!--        document.getElementById("valid").addEventListener("click", function(event) {-->
    <!--  // Prevent the default form submission behavior-->
    <!--  event.preventDefault();-->

    <!--  // Redirect to another webpage-->
    <!--  window.location.href = "{{ validate_url }}";-->
    <!--});-->

    <!--    </script>-->
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
        crossorigin="anonymous"></script>
</body>
</html>